<template>
  <div class="page">
    <div class="navbar">
      <div class="navbar-inner sliding">
        <div class="left">
          <a href="#" class="link back">
            <i class="icon icon-back"></i>
            <span class="ios-only">Back</span>
          </a>
        </div>
        <div class="title">{{$route.params.title}}</div>
      </div>
    </div>
    <div class="page-content">
      <img class="responsive" src="img/back.jpg" />
      <div class="swiper-container">
        <div class="swiper-wrapper">
        </div>
      </div>
    </div>
  </div>
</template>
<script>
  return {
    // Page Events
    on: {
      pageInit: function(e, page) {
      
        var swiper = app.swiper.create('.swiper-container', {
          speed: 400,
          spaceBetween: 0
        });

        var db = self.$app.data.db;
        var bab = self.$route.params.anu;
        //console.log('bab: ', bab)
    
        if (db) {
        
          db.transaction(function(tx) {
            
            tx.executeSql('select bab, ayat, sloka, indo, favorit from book where bab = ? order by ayat;', [bab], function(ignored, res) {
              
              var sloka = [];
              
              for (var i = 0; i < res.rows.length; i++) {
                var html = '<div class="swiper-slide">'
                    html += '<div class="card">'
                       html += '<input type="hidden" class="bab" value="' + res.rows.item(0).bab + '" />'
                       html += '<input type="hidden" class="ayat" value="' + res.rows.item(0).ayat + '" />'
                       html += '<div class="card-header">'
                          html += '<div class="article-title text-center">Sloka ' + res.rows.item(0).ayat + '</div>'
                       html += '</div>'
                       html += '<div class="card-footer">'
                          html += '<div class="intro">' + res.rows.item(0).indo + '</div>'
                       html += '</div>'
                       html += '<div class="card-footer">'
                        html += '<div class="icon-social"><a href="#" class="link icon-only"><i class="material-icons share art-share">share</i></a></div>'
                        html += '<div class="icon-social"><a href="#" class="link icon-only"><i class="material-icons fav'
                        if (res.rows.item(0).favorit)
                          html += ' color-change'
                        html += '">favorite</i></a></div>'
                       html += '</div>'
                    html += '</div>'
                  html += '</div>'

                sloka.push(html);
              }
            });
          }, function(error) {
            //app.preloader.hide();
            //app.dialog.alert('select error: ' + error.message);
          });
        }
        swiper.appendSlide(sloka);
      }
    }
  }
</script>
