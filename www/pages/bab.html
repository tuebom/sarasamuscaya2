<template>
  <div class="page">
    <div class="navbar">
      <div class="navbar-inner sliding">
        <div class="left">
          <a href="#" class="link back">
            <i class="icon icon-back"></i>
            <span class="ios-only">Back</span>
          </a>
        </div>
        <div class="title">{{$route.params.title}}</div>
      </div>
    </div>
    <div class="page-content">
      <img class="responsive" src="img/back.jpg" />
      <div class="swiper-container">
        <div class="swiper-wrapper">
          {{#each sloka}}
          <div class="swiper-slide">
            <div class="card">
               <input type="hidden" class="bab" value="{{this.bab}}" />
               <input type="hidden" class="ayat" value="{{this.ayat}}" />
               <div class="card-header">
                  <div class="article-title text-center">Sloka {{this.ayat}}</div>
               </div>
               <div class="card-footer">
                  <div class="intro">{{this.indo}}</div>
               </div>
               <div class="card-footer"> 
                <div class="icon-social"><a href="#" class="link icon-only"><i class="material-icons share art-share">share</i></a></div>
                <div class="icon-social"><a href="#" class="link icon-only"><i class="material-icons fav{{#if favorit}} color-change{{/if}}">favorite</i></a></div>
               </div>
            </div>
          </div>
          {{/each}}
        </div>
      </div>
    </div>
  </div>
</template>
<script>
  return {
    // Component Data
    data: function () {
      // Must return an object
      return {
        sloka: function () {
          var self = this;
          var db = self.$app.data.db;
          var bab = self.$route.params.anu;
          //console.log('bab: ', bab)
      
          if (db) {
          
            db.transaction(function(tx) {
              
              tx.executeSql('select bab, ayat, sloka, indo, favorit from book where bab = ? order by ayat;', [bab], function(ignored, res) {
                
                var sloka = [];
                //sloka.push({bab: res.rows.item(0).bab, ayat: res.rows.item(0).ayat, indo: res.rows.item(0).indo, favorit: res.rows.item(0).favorit});
                app.dialog.alert('first sloka: ' + JSON.stringify(res.rows.item(0)));
                
                //app.dialog.alert('length of sloka: ' + res.rows.length);
                
                for (var i = 0; i < res.rows.length; i++) {
                  sloka.push({bab: res.rows.item(i).bab, ayat: res.rows.item(i).ayat, indo: res.rows.item(i).indo, favorit: res.rows.item(i).favorit});
                }
                //return sloka;
              });
            }, function(error) {
              app.preloader.hide();
              app.dialog.alert('select error: ' + error.message);
            });
            return sloka;
            
          } else {
          
            var sloka = [];
            sloka.push(    {
                  bab: 1,
                  ayat: 1,
                  indo: 'Anaknda Janamejaya, segala ajaran tentang Catur Warga (Dharma=kebajikan, Artha=kekayaan, Kama=kesenangan dan Moksa=kebebasan) baikpun sumber, maupun uraian tafsirnya ada di sini; segala yang terdapat di sini akan terdapat dalam sastra lain; yang tidak terdapat di sini juga tidak akan terdapat pada sastra lain.',
                  favorit: 0
                });
            sloka.push(    {
                  bab: 1,
                  ayat: 2,
                  indo: 'Manusia adalah satu-satunya mahluk yang dapat melakukan kebajikan pun kejahatan. Terlahir menjadi manusia bertujuan untuk melebur perbuatan-perbuatan jahat ke dalam perbuatan-perbuatan bajik, hingga tidak ada lagi perbuatan-perbuatan jahat yang masih tersisa dalam diri, inilah hakekat menjadi manusia. Hanya dengan menjadi manusia kejahatan itu dapat dilebur dalam kebajikan.',
                  favorit: 1
                });          
          }
          //console.log(sloka)
          return sloka;
        },
      }
    },
    /*mounted() {
      // console.log('componentMounted', this);
      var swiper = app.swiper.create('.swiper-container', {
        speed: 400,
        spaceBetween: 0
      });
    },*/
    // Page Events
    on: {
      pageMounted: function(e, page) {
        console.log('pageMounted', page);
      },
      pageInit: function(e, page) {
        
        var swiper = app.swiper.create('.swiper-container', {
          speed: 400,
          spaceBetween: 0,
          slidesPerView: 1
        });
      }
    }
  }
</script>
